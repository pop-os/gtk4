Index: gtk+3.0-2.90.5/gtk/gtkrc.c
===================================================================
--- gtk+3.0-2.90.5.orig/gtk/gtkrc.c	2010-07-10 03:00:19.000000000 +0200
+++ gtk+3.0-2.90.5/gtk/gtkrc.c	2010-07-30 19:12:34.775081660 +0200
@@ -450,6 +450,17 @@
       if (im_module_file)
         result = g_strdup (im_module_file);
       else
+#if defined(__linux__) && ( defined(__i386__) || defined (__x86_64__) || defined(__ia64__) )
+# if defined (__i386__)
+        result = gtk_rc_make_default_dir ("immodules.cache.32");
+# else
+        result = gtk_rc_make_default_dir ("immodules.cache.64");
+# endif
+        /* Prefer compat immodules.cache file if it's usable. */
+        if (g_file_test(result, G_FILE_TEST_EXISTS))
+          return result;
+        g_free (result);
+#endif
         result = gtk_rc_make_default_dir ("immodules.cache");
     }
 
@@ -522,7 +533,21 @@
   else
     {
       const gchar *home;
+#if defined(__linux__) && ( defined(__i386__) || defined (__x86_64__) || defined(__ia64__) )
+# if defined (__i386__)
+      str = g_build_filename (GTK_SYSCONFDIR, "gtk-3.0", "gtkrc.32", NULL);
+# else
+      str = g_build_filename (GTK_SYSCONFDIR, "gtk-3.0", "gtkrc.64", NULL);
+# endif
+      /* Prefer compat gtkrc if it's usable. */
+      if (!g_file_test(str, G_FILE_TEST_EXISTS))
+        {
+          g_free (str), /* continue in next line */
+#endif
       str = g_build_filename (GTK_SYSCONFDIR, "gtk-3.0", "gtkrc", NULL);
+#if defined(__linux__) && ( defined(__i386__) || defined (__x86_64__) || defined(__ia64__) )
+        }
+#endif
 
       gtk_rc_add_default_file (str);
       g_free (str);
@@ -530,7 +555,21 @@
       home = g_get_home_dir ();
       if (home)
 	{
+#if defined(__linux__) && ( defined(__i386__) || defined (__x86_64__) || defined(__ia64__) )
+# if defined (__i386__)
+	  str = g_build_filename (home, ".gtkrc-3.0.32", NULL);
+# else
+	  str = g_build_filename (home, ".gtkrc-3.0.64", NULL);
+# endif
+          /* Prefer compat .gtkrc-3.0 if it's usable. */
+          if (!g_file_test(str, G_FILE_TEST_EXISTS))
+            {
+              g_free (str), /* continue in next line */
+#endif
 	  str = g_build_filename (home, ".gtkrc-3.0", NULL);
+#if defined(__linux__) && ( defined(__i386__) || defined (__x86_64__) || defined(__ia64__) )
+            }
+#endif
 	  gtk_rc_add_default_file (str);
 	  g_free (str);
 	}
